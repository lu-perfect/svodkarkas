import type { NextPage } from 'next';

import Typography from "components/UI/Typography";
import Container from "components/UI/Container";
import Button from "components/UI/Button";
import Layout from 'components/Layout';
import Box from "components/UI/Box";
import {formatPrice} from "../../utils/formatPrice";
import {data} from "../../data";
import List from "../../components/UI/List";
import ListItem from "../../components/UI/ListItem";
import {useRouter} from "next/router";
import Slider from "../../components/Slider";
import {ReactElement, useState} from "react";
import Icon from "../../components/UI/Icon";

const PackageHeader = ({ title } : { title: string }) => (
  <Box className="package-header">
    <Typography>Комплектация</Typography>
    <Typography tag="h3">«{title}»</Typography>
  </Box>
);

const PackageFooter = ({ price } : { price: number }) => (
  <Box className="package-footer">
    <Typography className="package-footer-title">Итого к заказу</Typography>
    <Typography tag="h4" className="h2 price">
      {formatPrice(price)}
    </Typography>

    <Button variant="slider">
      Заказать этот проект
    </Button>
  </Box>
);

const PackageRow = ({ i, title, paragraphs } : Omit<PackageBlock, 'id'> & { i: number }) => (
  <Box className="package-row" style={{ gridRow: i + 2 }}>
    <Typography className="package-row-title">
      {title}
    </Typography>

    {(() => {
      if (paragraphs.length === 0) {
        return <></>;
      }

      if (paragraphs.length === 1) {
        return (
          <Typography className={paragraphs[0].isEmpty ? 'is-empty' : ''} tag="p">
            {paragraphs[0].content}
          </Typography>
        );
      }

      return (
        <List>
          {paragraphs.map((paragraph) => (
            <ListItem key={paragraph.id}>
              <Typography className={paragraph.isEmpty ? 'is-empty' : ''} tag="p">
                {paragraph.content}
              </Typography>
            </ListItem>
          ))}
        </List>
      );
    })()}

  </Box>
);

const Package = ({ title, blocks, price } : Omit<Package, 'id'> & { price: number }) => (
  <>
    <PackageHeader title={title} />

    <>
      {blocks.map((block, i) => (
        <PackageRow
          key={block.id}
          i={i}
          title={block.title}
          paragraphs={block.paragraphs}
        />
      ))}
    </>

    <PackageFooter price={price} />
  </>
);

const TabHead = ({ icon, caption } : { icon: ReactElement, caption: string }) => (
  <ListItem className="tab">
    <Box className="icon-wrapper">
      {icon}
    </Box>
    <Typography>{caption}</Typography>
  </ListItem>
);

const ProjectPage: NextPage = () => {
  const router = useRouter();

  const [tab, setTab] = useState<'prices' | 'about' | 'gallery' >('about');

  return (
    <Layout>
      <section className="project-promo">
        <Container>
          <Typography tag="h1" className="h2 title">
            Проект дома {router.query.id}
          </Typography>

          <Box className="sidebar">
            <List>
              <ListItem>
                <strong>Площадь: </strong>
                <Typography>125 м²</Typography>
              </ListItem>
              <ListItem>
                <strong>Размеры: </strong>
                <Typography>7 x 9 м</Typography>
              </ListItem>
              <ListItem>
                <strong>Спален: </strong>
                <Typography>4</Typography>
              </ListItem>
              <ListItem>
                <strong>Санузлов: </strong>
                <Typography>2</Typography>
              </ListItem>

              <ListItem className="price">
                <strong>Цена: </strong>
                <Typography>
                  от {formatPrice(5626000)}
                </Typography>
              </ListItem>
            </List>

            <Button variant="slider">
              Хочу этот проект
            </Button>
          </Box>

          <Box className="slider-wrapper">
            <Slider
              slides={[
                'https://svodkarkas.ru/storage/projects/16/bg_th3.webp?1626451562',

                'https://svodkarkas.ru/storage/projects/16/facades/san1.png',
                'https://svodkarkas.ru/storage/projects/16/facades/san2.png',
                'https://svodkarkas.ru/storage/projects/16/facades/san3.png',

                'https://svodkarkas.ru/storage/projects/16/plains/sanp1.jpeg',
                'https://svodkarkas.ru/storage/projects/16/plains/sanp2.jpeg'
              ]}
            />
          </Box>
        </Container>
      </section>

      <section className="project-info">
        <Container>
          <List className="tabs">
            <TabHead
              icon={(
                <Icon viewBox="0 0 502 502">
                  <path d="M10,140.444c5.522,0,10-4.477,10-10V82.222c0-5.523-4.478-10-10-10s-10,4.477-10,10v48.222     C0,135.967,4.478,140.444,10,140.444z"/>
                  <path d="M10,429.778c5.522,0,10-4.477,10-10v-48.222c0-5.523-4.478-10-10-10s-10,4.477-10,10v48.222     C0,425.301,4.478,429.778,10,429.778z"/>
                  <path d="M10,236.889c5.522,0,10-4.477,10-10v-48.223c0-5.523-4.478-10-10-10s-10,4.477-10,10v48.223     C0,232.412,4.478,236.889,10,236.889z"/>
                  <path d="M10,333.333c5.522,0,10-4.477,10-10v-48.222c0-5.523-4.478-10-10-10s-10,4.477-10,10v48.222     C0,328.856,4.478,333.333,10,333.333z"/>
                  <path d="M10,44c5.522,0,10-4.477,10-10V20h14c5.522,0,10-4.477,10-10S39.522,0,34,0H10C4.478,0,0,4.477,0,10v24     C0,39.523,4.478,44,10,44z"/>
                  <path d="M371.556,20h48.223c5.522,0,10-4.477,10-10s-4.478-10-10-10h-48.223c-5.522,0-10,4.477-10,10S366.033,20,371.556,20z"/>
                  <path d="M178.667,20h48.223c5.522,0,10-4.477,10-10s-4.478-10-10-10h-48.223c-5.522,0-10,4.477-10,10S173.145,20,178.667,20z"/>
                  <path d="M82.223,20h48.223c5.522,0,10-4.477,10-10s-4.478-10-10-10H82.223c-5.522,0-10,4.477-10,10S76.7,20,82.223,20z"/>
                  <path d="M275.111,20h48.223c5.522,0,10-4.477,10-10s-4.478-10-10-10h-48.223c-5.522,0-10,4.477-10,10S269.589,20,275.111,20z"/>
                  <path d="M492,0h-24c-5.522,0-10,4.477-10,10s4.478,10,10,10h14v14c0,5.523,4.478,10,10,10c5.522,0,10-4.477,10-10V10     C502,4.477,497.522,0,492,0z"/>
                  <path d="M492,265.111c-5.522,0-10,4.477-10,10v48.223c0,5.523,4.478,10,10,10c5.522,0,10-4.477,10-10v-48.223     C502,269.588,497.522,265.111,492,265.111z"/>
                  <path d="M492,72.222c-5.522,0-10,4.477-10,10v48.222c0,5.523,4.478,10,10,10c5.522,0,10-4.477,10-10V82.222     C502,76.699,497.522,72.222,492,72.222z"/>
                  <path d="M492,361.556c-5.522,0-10,4.477-10,10v48.222c0,5.523,4.478,10,10,10c5.522,0,10-4.477,10-10v-48.222     C502,366.033,497.522,361.556,492,361.556z"/>
                  <path d="M492,168.667c-5.522,0-10,4.477-10,10v48.222c0,5.523,4.478,10,10,10c5.522,0,10-4.477,10-10v-48.222     C502,173.144,497.522,168.667,492,168.667z"/>
                  <path d="M492,458c-5.522,0-10,4.477-10,10v14H20v-14c0-5.523-4.478-10-10-10s-10,4.477-10,10v24c0,5.523,4.478,10,10,10h482     c5.522,0,10-4.477,10-10v-24C502,462.477,497.522,458,492,458z"/>
                  <path d="M251,419.5c-5.522,0-10,4.477-10,10V457c0,5.523,4.478,10,10,10c5.522,0,10-4.477,10-10v-27.5     C261,423.977,256.522,419.5,251,419.5z"/>
                  <path d="M251,184.5c5.522,0,10-4.477,10-10v-51c0-5.523-4.478-10-10-10c-5.522,0-10,4.477-10,10v51     C241,180.023,245.478,184.5,251,184.5z"/>
                  <path d="M261,327.5c0-5.523-4.478-10-10-10c-5.522,0-10,4.477-10,10v51c0,5.523,4.478,10,10,10c5.522,0,10-4.477,10-10V327.5z"/>
                  <path d="M251,82.5c5.522,0,10-4.477,10-10V45c0-5.523-4.478-10-10-10c-5.522,0-10,4.477-10,10v27.5     C241,78.023,245.478,82.5,251,82.5z"/>
                  <path d="M35,251c0,5.523,4.478,10,10,10h27.5c5.522,0,10-4.477,10-10s-4.478-10-10-10H45C39.478,241,35,245.477,35,251z"/>
                  <path d="M327.5,241c-5.522,0-10,4.477-10,10s4.478,10,10,10h51c5.522,0,10-4.477,10-10s-4.478-10-10-10H327.5z"/>
                  <path d="M215.5,251c0,5.523,4.478,10,10,10H241v15.5c0,5.523,4.478,10,10,10c5.522,0,10-4.477,10-10V261h15.5     c5.522,0,10-4.477,10-10s-4.478-10-10-10H261v-15.5c0-5.523-4.478-10-10-10c-5.522,0-10,4.477-10,10V241h-15.5     C219.978,241,215.5,245.477,215.5,251z"/>
                  <path d="M123.5,241c-5.522,0-10,4.477-10,10s4.478,10,10,10h51c5.522,0,10-4.477,10-10s-4.478-10-10-10H123.5z"/>
                  <path d="M419.5,251c0,5.523,4.478,10,10,10H457c5.522,0,10-4.477,10-10s-4.478-10-10-10h-27.5     C423.978,241,419.5,245.477,419.5,251z"/>
                </Icon>
              )}
              caption="Комплектации и цены"
            />
            <TabHead
              icon={(
                <Icon viewBox="0 0 512 512">
                  <path d="M135.91,462.046c-3.465-20.062-21.001-35.379-42.044-35.379c-16.802,0-31.36,9.762-38.315,23.91     c-1.374-0.981-2.842-1.852-4.352-2.637V307.2c0-4.71-3.823-8.533-8.533-8.533c-4.71,0-8.533,3.823-8.533,8.533v136.533     C15.309,443.733,0,459.042,0,477.867S15.309,512,34.133,512H128c14.114,0,25.6-11.486,25.6-25.6     C153.6,475.042,146.167,465.391,135.91,462.046z M128,494.933H34.133c-9.412,0-17.067-7.654-17.067-17.067     S24.721,460.8,34.133,460.8c7.962,0,15.036,4.625,17.604,11.52c1.442,3.866,5.436,6.144,9.515,5.41     c4.062-0.734,7.014-4.267,7.014-8.397c0-14.114,11.486-25.6,25.6-25.6s25.6,11.486,25.6,25.6c0,4.71,3.823,8.533,8.533,8.533     c4.702,0,8.533,3.831,8.533,8.533S132.702,494.933,128,494.933z"/>
                  <path d="M503.467,68.267H341.333c-4.71,0-8.533,3.823-8.533,8.533s3.823,8.533,8.533,8.533h153.6v184.201l-232.9-232.9     c-1.673-1.673-3.866-2.5-6.059-2.5s-4.386,0.828-6.059,2.5L17.067,269.525V85.333h93.867c4.71,0,8.533-3.823,8.533-8.533V42.667     c0-4.71-3.823-8.533-8.533-8.533H102.4V17.067h51.2v17.067h-8.533c-4.71,0-8.533,3.823-8.533,8.533V76.8     c0,4.71,3.823,8.533,8.533,8.533h25.6c4.71,0,8.533-3.823,8.533-8.533s-3.823-8.533-8.533-8.533H153.6V51.2h8.533     c4.71,0,8.533-3.823,8.533-8.533V8.533c0-4.71-3.823-8.533-8.533-8.533H93.867c-4.71,0-8.533,3.823-8.533,8.533v34.133     c0,4.71,3.823,8.533,8.533,8.533h8.533v17.067H8.533c-2.261,0-4.437,0.896-6.033,2.5C0.896,72.363,0,74.539,0,76.8l0.034,213.333     c0,3.456,2.082,6.562,5.274,7.885c1.058,0.435,2.159,0.649,3.26,0.649c2.227,0,4.412-0.87,6.033-2.5L255.974,54.707     l241.459,241.459c1.63,1.63,3.814,2.5,6.033,2.5c1.101,0,2.21-0.213,3.268-0.649c3.183-1.323,5.265-4.437,5.265-7.885V76.8     C512,72.09,508.177,68.267,503.467,68.267z"/>
                  <path d="M477.867,443.733V307.2c0-4.71-3.823-8.533-8.533-8.533s-8.533,3.823-8.533,8.533v140.74     c-1.51,0.785-2.978,1.655-4.352,2.637c-6.955-14.148-21.513-23.91-38.315-23.91c-21.043,0-38.579,15.317-42.044,35.379     c-10.257,3.345-17.69,12.996-17.69,24.354c0,3.012,0.614,5.854,1.579,8.533H213.333c-4.71,0-8.533,3.823-8.533,8.533     s3.823,8.533,8.533,8.533H384h34.133h59.733C496.691,512,512,496.691,512,477.867S496.691,443.733,477.867,443.733z      M477.867,494.933h-59.733H384c-4.702,0-8.533-3.831-8.533-8.533s3.831-8.533,8.533-8.533c4.71,0,8.533-3.823,8.533-8.533     c0-14.114,11.486-25.6,25.6-25.6s25.6,11.486,25.6,25.6c0,4.13,2.953,7.663,7.014,8.397c4.053,0.742,8.073-1.545,9.515-5.41     c2.568-6.895,9.643-11.52,17.604-11.52c9.412,0,17.067,7.654,17.067,17.067S487.279,494.933,477.867,494.933z"/>
                  <path d="M290.133,170.667c0-18.825-15.309-34.133-34.133-34.133c-18.825,0-34.133,15.309-34.133,34.133S237.175,204.8,256,204.8     C274.825,204.8,290.133,189.491,290.133,170.667z M238.933,170.667c0-9.412,7.654-17.067,17.067-17.067     c9.412,0,17.067,7.654,17.067,17.067c0,9.412-7.654,17.067-17.067,17.067C246.588,187.733,238.933,180.079,238.933,170.667z"/>
                  <path d="M418.133,290.133h-68.267c-4.71,0-8.533,3.823-8.533,8.533v93.867H332.8c-4.71,0-8.533,3.823-8.533,8.533     s3.823,8.533,8.533,8.533h102.4c4.71,0,8.533-3.823,8.533-8.533s-3.823-8.533-8.533-8.533h-8.533v-93.867     C426.667,293.956,422.844,290.133,418.133,290.133z M409.6,392.533h-51.2V358.4h51.2V392.533z M409.6,341.333h-51.2V307.2h51.2     V341.333z"/>
                  <path d="M341.333,469.333c0-4.71-3.823-8.533-8.533-8.533h-25.6V298.667c0-4.71-3.823-8.533-8.533-8.533h-85.333     c-4.71,0-8.533,3.823-8.533,8.533V460.8h-25.6c-4.71,0-8.533,3.823-8.533,8.533v34.133c0,4.71,3.823,8.533,8.533,8.533     s8.533-3.823,8.533-8.533v-25.6H332.8C337.51,477.867,341.333,474.044,341.333,469.333z M290.133,375.467H281.6     c-4.71,0-8.533,3.823-8.533,8.533s3.823,8.533,8.533,8.533h8.533V460.8h-68.267V307.2h68.267V375.467z"/>
                  <path d="M162.133,290.133H93.867c-4.71,0-8.533,3.823-8.533,8.533v93.867H76.8c-4.71,0-8.533,3.823-8.533,8.533     S72.09,409.6,76.8,409.6h102.4c4.71,0,8.533-3.823,8.533-8.533s-3.823-8.533-8.533-8.533h-8.533v-93.867     C170.667,293.956,166.844,290.133,162.133,290.133z M153.6,392.533h-51.2V358.4h51.2V392.533z M153.6,341.333h-51.2V307.2h51.2     V341.333z"/>
                </Icon>
              )}
              caption="О проекте"
            />
            <TabHead
              icon={(
                <Icon viewBox="0 0 512 512">
                  <path d="M345.089,459.056H48.407c-17.432,0-31.614-14.182-31.614-31.615V84.558c0-17.433,14.182-31.615,31.614-31.615h56.61    c4.638,0,8.396-3.759,8.396-8.396s-3.758-8.396-8.396-8.396h-56.61C21.715,36.151,0,57.867,0,84.558v342.883    c0,26.693,21.715,48.408,48.407,48.408h296.683c4.638,0,8.396-3.759,8.396-8.396S349.727,459.056,345.089,459.056z"/>
                  <path d="M463.593,36.15H136.026c-4.638,0-8.396,3.759-8.396,8.396s3.758,8.397,8.396,8.397h327.568    c17.432,0,31.614,14.182,31.614,31.615v342.883c0,17.433-14.182,31.615-31.614,31.615h-84.919c-4.638,0-8.396,3.759-8.396,8.396    s3.758,8.396,8.396,8.396h84.919c26.692,0,48.407-21.715,48.407-48.408V84.558C512,57.867,490.285,36.15,463.593,36.15z"/>
                  <path d="M440.507,73.792H71.494c-18.668,0-33.854,15.186-33.854,33.854v54.07c-0.003,0.113-0.001,0.225,0,0.338v242.3    c0,18.629,15.124,33.788,33.738,33.852c0.038,0,0.077,0.006,0.116,0.006c0.01,0,0.019-0.002,0.029-0.002h123.925    c0.012,0,0.025,0.002,0.036,0.002c0,0,0.018-0.002,0.027-0.002h244.996c18.666-0.001,33.853-15.187,33.853-33.855v-170.35    c0-0.004,0-0.009,0-0.013V107.646C474.36,88.978,459.173,73.792,440.507,73.792z M66.128,420.538    c-6.784-2.257-11.694-8.653-11.694-16.184v-61.325c18.11-19.773,40.655-30.34,67.087-31.365c8.115-0.316,15.441,0.357,21.383,1.3    C108.92,342.889,81.362,383.442,66.128,420.538z M54.433,166.28c7.25-4.757,15.615-7.254,24.42-7.254    c19.284,0,36.325,12.292,42.405,30.59c0.798,2.404,2.639,4.318,5.011,5.21c2.369,0.891,5.017,0.667,7.203-0.613    c7.462-4.373,15.988-6.684,24.657-6.684c24.677,0,45.526,18.451,48.494,42.918c0.47,3.878,3.554,6.92,7.439,7.337    c17.43,1.873,31.739,14.426,36.464,30.746c-13.721-0.844-27.871,0.978-42.19,5.526c-16.911,5.371-33.281,14.218-48.647,25.42    c-6.81-1.968-20.807-5.183-38.094-4.616c-18.445,0.606-43.672,5.774-67.161,25.052V166.28H54.433z M457.566,404.354    c0,9.407-7.653,17.061-17.06,17.061H209.175c4.955-8.942,10.609-17.663,16.148-26.175c3.732-5.737,7.593-11.671,11.212-17.63    c2.406-3.964,1.143-9.129-2.82-11.536c-3.963-2.405-9.127-1.144-11.536,2.82c-3.482,5.736-7.27,11.558-10.933,17.188    c-7.342,11.285-14.898,22.911-21.052,35.334H83.971c29.733-68.724,86.451-117.7,129.446-131.356    c25.683-8.157,49.799-6.355,71.844,5.335c-1.611,1.487-3.216,2.99-4.814,4.518c-10.743,10.274-21.354,21.656-31.538,33.832    c-1.16,1.387-2.312,2.78-3.456,4.18c-2.933,3.591-2.4,8.881,1.19,11.814c3.482,2.845,8.905,2.372,11.815-1.19    c1.102-1.349,2.211-2.691,3.331-4.029c9.787-11.701,19.969-22.625,30.264-32.469c11.674-11.164,23.73-21.164,35.833-29.727    c13.364-9.453,27.097-17.377,40.82-23.553c15.048-6.771,30.469-11.614,45.832-14.392c14.154-2.56,28.595-3.411,43.027-2.575    V404.354z M457.566,224.996c-15.437-0.819-30.873,0.12-46.017,2.858c-16.708,3.022-33.44,8.272-49.733,15.604    c-14.707,6.617-29.385,15.082-43.628,25.158c-6.557,4.638-13.093,9.676-19.561,15.062c-9.688-5.821-19.853-9.989-30.359-12.504    c-3.764-24.083-22.254-43.79-46.051-49.046c-6.573-29.706-33.082-51.391-64.09-51.391c-8.467,0-16.835,1.642-24.627,4.796    c-10.411-20.244-31.339-33.299-54.648-33.299c-8.55,0-16.797,1.718-24.42,5.028v-39.615h0.001c0-9.407,7.654-17.061,17.061-17.061    h369.011c9.407,0,17.06,7.654,17.06,17.061V224.996z"/>
                  <path d="M340.64,132.32c-24.442,0-44.328,19.886-44.328,44.328s19.886,44.328,44.328,44.328c24.442,0,44.328-19.886,44.328-44.328    C384.969,152.206,365.083,132.32,340.64,132.32z M340.64,204.185c-15.184,0-27.536-12.353-27.536-27.536    c0.001-15.184,12.353-27.536,27.536-27.536c15.184,0,27.536,12.352,27.536,27.536C368.176,191.832,355.824,204.185,340.64,204.185    z"/>
                </Icon>
              )}
              caption="Фотогалерея"
            />
          </List>
        </Container>
      </section>

      <section className="project-packages">
        <Container>
          <Box className="project-packages-grid">
            <Package price={5626000} title={data.packages[0].title} blocks={data.packages[0].blocks} />
            <Package price={6723000} title={data.packages[1].title} blocks={data.packages[1].blocks} />
            <Package price={6980000} title={data.packages[2].title} blocks={data.packages[2].blocks} />
          </Box>
        </Container>
      </section>
    </Layout>
  )
}

export default ProjectPage;
